<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:ital,opsz,wght@0,6..12,200..1000;1,6..12,200..1000&display=swap" rel="stylesheet">
    <title>Cadastro Gerente</title>
    <link rel="stylesheet" href="./css/cadastroGerente.css">
</head>
<body>
    <div class="mae">
        <div class="espacohamburger"></div>
        <div class="mae_container">
            <div class="container">
                <div class="espacotitulo">
                    <h1>Dados de um Gerente já cadastrado </h1>
                </div>
                <div class="espaco_formu">
                    <div class="espaco_inputs">
                        <input type="text" id="nomeGerente" placeholder="">
                        <input type="text" id="cpfGerente" placeholder="">
                        <input type="text" id="emailGerente" placeholder="">
                        <input type="text" id="empresaGerente" disabled placeholder="">
                        <input type="text" id="cargoGerente" placeholder="">
                        <input type="password" id="senhaGerente" disabled placeholder="">
                        <button type="submit" class="save">Savar alterações</button>
                    </div>
                </div>
                <div class="buttons">
                    <button type="button" onclick="deletar(cpf)" class="delete">
                        Excluir Gerente
                    </button>
                </div>
            </div>
        </div>
    </div>    
</body>
</html>
<script>
    var gerente = JSON.parse(localStorage.getItem("gerenteSelecionado"));

    document.getElementById("nomeGerente").placeholder = gerente.nome;
    document.getElementById("cpfGerente").placeholder = gerente.CPF;
    document.getElementById("emailGerente").placeholder = gerente.email;
    document.getElementById("empresaGerente").placeholder = gerente.nome_empresa;
    document.getElementById("cargoGerente").placeholder = gerente.cargo;
    document.getElementById("senhaGerente").placeholder = gerente.senha;

    var cpf = gerente.CPF;

    function deletar(cpf) {
        console.log("Função de deletar gerente pelo CPF:" + cpf);
        fetch(`/avisos/deletar/${cpf}`, {
            method: "DELETE",
            headers: {
                "Content-Type": "application/json"
            }
        }).then(function (resposta) {
            if (resposta.ok) {
                window.alert("Gerente excluído com sucesso!");
                window.location = "./CadGerente.html";
            } else if (resposta.status == 404) {
                window.alert("Deu 404!");
            } else {
                throw ("Houve um erro ao tentar realizar a postagem! Código da resposta: " + resposta.status);
            }
        }).catch(function (erro) {
            console.log(`#ERRO: ${erro}`);
        });
    }
</script>