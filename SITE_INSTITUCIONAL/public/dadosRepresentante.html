<!DOCTYPE html>

<html lang="pt-BR">

<head>

    <meta charset="UTF-8">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="stylesheet" href="./css/cadastroGerente.css">

    <title>Seus dados - Representante</title>

</head>

<body onload="perfil()">

    <div class="content">
        <button class="hamburger" onclick="Navbar()">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
        </button>

        <nav id="navMenu" class="nav-menu">
            <button class="close-btn" onclick="Navbar()">
                <div class="bar"></div>
                <div class="bar"></div>
                <div class="bar"></div>
            </button>
            <img src="imagens/SecurePass SVGLogoNavBar.svg" alt="Logo" class="logo">
            <div class="separator"></div>
            <div class="nav-links">
                <a href="./CadGerente.html">Gestão Gerente</a>
                <a href="./CadMaquina.html">Gestão de Máquinas</a>
                <a href="./dadosRepresentante.html">Perfil</a>
                <a href="./feedbackRep.html">Feedback</a>
            </div>
            <a href="index.html" class="logout">Sair</a>
        </nav>
    </div>

    <div class="mae">
        <div class="espacohamburger"></div>
        <div class="mae_container">
            <div class="container">
                <div class="espacotitulo" style="width: 20%;">
                    <h1>Seus dados</h1>
                </div>
                <div class="espaco_formu">
                    <div class="espaco_inputs">
                        <input type="text" id="nomeRepresentante" placeholder="">
                        <input type="text" id="cpfRepresentante" placeholder="">
                        <input type="text" id="emailRepresentante" placeholder="">
                        <input type="text" id="empresaRepresentante" disabled placeholder="">
                        <input type="text" id="cargoRepresentante" placeholder="">
                        <input type="password" id="senhaRepresentante" disabled placeholder="">
                        <button type="submit" class="save">Salvar alterações</button>

                        <p class="texto-abaixo-botao">
                            Clique no botão acima apenas quando você tiver mudado alguma informação pessoal.
                        </p>
                    </div>
                </div>
                <p class="texto-canto-inferior">
                    Seu cargo: <strong>Representante</strong>
                </p>
            </div>
        </div>
    </div>

    <script>
        function Navbar() {
            const navMenu = document.getElementById('navMenu');
            const hamburger = document.querySelector('.hamburger');
            const closeBtn = document.querySelector('.close-btn');

            if (navMenu.classList.contains('show')) {
                navMenu.classList.remove('show');
                setTimeout(() => {
                    hamburger.style.display = 'block';
                    closeBtn.style.display = 'none';
                }, 300);
            } else {
                hamburger.style.display = 'none';
                closeBtn.style.display = 'block';
                navMenu.classList.add('show');
            }
        }

        function perfil() {
            var idUsuario = sessionStorage.getItem("ID_USUARIO");

            fetch("/avisos/dadosPerfil", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ idUsuarioServer: idUsuario }),
            })
            .then((resposta) => {
                if (resposta.ok) {
                    return resposta.json();
                } else {
                    throw "Houve um erro ao tentar realizar o cadastro!";
                }
            })
            .then((dados) => {
                if (dados.length > 0) {
                    var usuario = dados[0];

                    document.getElementById("nomeRepresentante").placeholder = usuario.nome;
                    document.getElementById("senhaRepresentante").placeholder = usuario.senha;
                    document.getElementById("empresaRepresentante").placeholder = usuario.nomeEmpresa;
                    document.getElementById("cpfRepresentante").placeholder = sessionStorage.getItem("CPF_USUARIO");
                    document.getElementById("emailRepresentante").placeholder = sessionStorage.getItem("EMAIL_USUARIO");
                    document.getElementById("cargoRepresentante").placeholder = sessionStorage.getItem("CARGO_USUARIO");
                } else {
                    console.warn("Nenhum dado encontrado para o usuário.");
                }
            })
            .catch((erro) => {
                console.error("#ERRO: ", erro);
            });

            return false;
        }
    </script>

</body>

</html>